# ðŸ“… 2025-11-25 SQL Study Log

## 1. IS NULL & CASE WHEN í™œìš©
**ëŒ€ë¶„ë¥˜**: SQL ë¸”ë¡œê¹…
**ì„¤ëª…**: IS NULL ì²˜ë¦¬ ë°©ë²•

### ê²½ê¸°ë„ì— ìœ„ì¹˜í•œ ì‹í’ˆì°½ê³  ëª©ë¡ ì¶œë ¥í•˜ê¸°
```sql
SELECT WAREHOUSE_ID,WAREHOUSE_NAME,ADDRESS,
CASE
WHEN FREEZER_YN IS NULL THEN 'N'
ELSE FREEZER_YN
END AS FREEZER_YN
FROM FOOD_WAREHOUSE
WHERE ADDRESS LIKE "ê²½ê¸°ë„%"
ORDER BY WAREHOUSE_ID
```

### ì—…ê·¸ë ˆì´ë“œ í•  ìˆ˜ ì—†ëŠ” ì•„ì´í…œ êµ¬í•˜ê¸°
`LEFT JOIN`ì„ í†µí•´ ë¶€ëª¨ ID ëª©ë¡ì— ì—†ëŠ” IDë§Œ ì¶”ì¶œí•˜ëŠ” í…Œí¬ë‹‰.
```sql
SELECT I.ITEM_ID,I.ITEM_NAME,I.RARITY
FROM ITEM_INFO I
LEFT JOIN ITEM_TREE T
ON I.ITEM_ID = T.PARENT_ITEM_ID
WHERE T.PARENT_ITEM_ID IS NULL
ORDER BY I.ITEM_ID DESC
```

### ìž¡ì€ ë¬¼ê³ ê¸°ì˜ í‰ê·  ê¸¸ì´ êµ¬í•˜ê¸°
`AVG` ë‚´ë¶€ì— `CASE WHEN`ì„ ë„£ì–´ `NULL` ê°’ì„ 10ìœ¼ë¡œ ì¹˜í™˜í•˜ì—¬ ê³„ì‚°.
```sql
SELECT ROUND(AVG(
CASE
WHEN LENGTH IS NULL THEN 10
ELSE LENGTH
END),2) AS AVERAGE_LENGTH
FROM FISH_INFO
```

---

## 2. JOIN ì‹¬í™” (ì¤‘ìš”)
**ëŒ€ë¶„ë¥˜**: SQL ë¸”ë¡œê¹…
**ì„¤ëª…**: ë³µìž¡í•œ ì¡°ê±´ì˜ JOINê³¼ ì§‘ê³„

### 2021ë…„ì— ê°€ìž…í•œ ì „ì²´ íšŒì› ì¤‘ êµ¬ë§¤ íšŒì› ë¹„ìœ¨
ì„œë¸Œì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ëª¨(2021ë…„ ê°€ìž…ìž ì „ì²´)ë¥¼ êµ¬í•˜ê³ , ë©”ì¸ ì¿¼ë¦¬ì—ì„œ ë¶„ìž(êµ¬ë§¤ìž)ë¥¼ êµ¬í•¨.

```sql
SELECT YEAR(O.SALES_DATE) AS YEAR,
       MONTH(O.SALES_DATE) AS MONTH,
       COUNT(DISTINCT(I.USER_ID)) AS PURCHASED_USERS,
       ROUND(COUNT(DISTINCT(I.USER_ID))/(SELECT COUNT(DISTINCT(I.USER_ID))
                                    FROM USER_INFO I
                                    WHERE YEAR(I.JOINED)='2021'),1) AS PUCHASED_RATIO
FROM USER_INFO I
    JOIN ONLINE_SALE O
    ON I.USER_ID = O.USER_ID
WHERE YEAR(I.JOINED)='2021'
GROUP BY YEAR, MONTH
ORDER BY YEAR, MONTH
```

### íŠ¹ì • ê¸°ê°„ë™ì•ˆ ëŒ€ì—¬ ê°€ëŠ¥í•œ ìžë™ì°¨ë“¤ì˜ ëŒ€ì—¬ë¹„ìš© êµ¬í•˜ê¸° (Level 4)
ê¸°ê°„ ì¤‘ë³µì„ ê±¸ëŸ¬ë‚´ëŠ” í•µì‹¬ ë¡œì§:
`NOT IN` ì„œë¸Œì¿¼ë¦¬ ì‚¬ìš©.
```sql
WHERE (DATE_FORMAT(END_DATE,"%Y-%m-d") >= '2022-11-01' AND
       DATE_FORMAT(START_DATE,"%Y-%m-d") <= '2022-11-30')
```
ì´ ì¡°ê±´ì— ê±¸ë¦¬ëŠ” ì°¨ë“¤ì€ 'ëŒ€ì—¬ ë¶ˆê°€ëŠ¥'í•˜ë¯€ë¡œ ì´ë“¤ì„ ì œì™¸í•œë‹¤.

```sql
WITH RECENT_ID AS(
SELECT C.CAR_ID,C.CAR_TYPE,C.DAILY_FEE
FROM CAR_RENTAL_COMPANY_CAR C
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY H
ON C.CAR_ID = H.CAR_ID
WHERE C.car_type IN ('ì„¸ë‹¨','SUV') AND
C.CAR_ID NOT IN (
    -- ëŒ€ì—¬ ë¶ˆê°€ëŠ¥í•œ ì°¨ ëª©ë¡
    SELECT CAR_ID
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE (DATE_FORMAT(END_DATE,"%Y-%m-d") >= '2022-11-01' AND
    DATE_FORMAT(START_DATE,"%Y-%m-d") <= '2022-11-30')
    GROUP BY CAR_ID
)
GROUP BY C.CAR_ID
)
SELECT ... -- ìš”ê¸ˆ ê³„ì‚° ë¡œì§
```

### ê·¸ë£¹ë³„ ì¡°ê±´ì— ë§žëŠ” ì‹ë‹¹ ëª©ë¡ ì¶œë ¥í•˜ê¸°
ë¦¬ë·° ìˆ˜ê°€ ê°€ìž¥ ë§Žì€ ì‚¬ëžŒì„ ë¨¼ì € ì°¾ê³ , ê·¸ ì‚¬ëžŒì˜ ë¦¬ë·°ë¥¼ ì¡°ì¸.

```sql
WITH review_cnt AS (
    SELECT MEMBER_ID, COUNT(*) AS COUNT
    FROM REST_REVIEW
    GROUP BY MEMBER_ID
),
MAX_CNT AS (
    SELECT MAX(COUNT) AS MAX_COUNT
    FROM review_cnt
)
SELECT MP.MEMBER_NAME, RE.REVIEW_TEXT, DATE_FORMAT(RE.REVIEW_DATE,'%Y-%m-%d')
FROM REST_REVIEW AS RE
JOIN review_cnt r ON RE.MEMBER_ID = r.MEMBER_ID
JOIN MAX_CNT m ON r.COUNT = m.MAX_COUNT
JOIN MEMBER_PROFILE AS MP ON RE.MEMBER_ID = MP.MEMBER_ID
ORDER BY REVIEW_DATE, RE.REVIEW_TEXT
```
