# [LV_4] [재풀이 필요] 입양 시각 구하기(2)

> **정보**
> - **날짜**: 2026년 1월 19일
> - **분류**: 프로그래머스 (LV_4)
> - **주제**: GROUP BY
> - **재풀이 여부**: O

### ✨ 핵심 포인트
- `UNION`에서 `NULL AS col`로 맞추는 건 “없는 컬럼을 채우는 문제”이다.
- 이번 문제에서 틀린 이유는 “없는 컬럼이 아니라 **존재하지 않는 행(row)**을 SQL이 자동으로 만들어줄 거라 착각했기 때문”이다.
- 먼저 필요한 행(시간 0~23)을 생성(`WITH RECURSIVE`)한 뒤, 그 기준에 `LEFT JOIN`해서 해결해야 한다.

### 🎯 문제 설명

`ANIMAL_OUTS` 테이블은 동물 보호소에서 입양 보낸 동물의 정보를 담은 테이블입니다. `ANIMAL_OUTS` 테이블 구조는 다음과 같으며, `ANIMAL_ID`, `ANIMAL_TYPE`, `DATETIME`, `NAME`, `SEX_UPON_OUTCOME`는 각각 동물의 아이디, 생물 종, 입양일, 이름, 성별 및 중성화 여부를 나타냅니다.

| NAME | TYPE | NULLABLE |
| --- | --- | --- |
| ANIMAL_ID | VARCHAR(N) | FALSE |
| ANIMAL_TYPE | VARCHAR(N) | FALSE |
| DATETIME | DATETIME | FALSE |
| NAME | VARCHAR(N) | TRUE |
| SEX_UPON_OUTCOME | VARCHAR(N) | FALSE |

보호소에서는 몇 시에 입양이 가장 활발하게 일어나는지 알아보려 합니다. 0시부터 23시까지, 각 시간대별로 입양이 몇 건이나 발생했는지 조회하는 SQL문을 작성해주세요. 이때 결과는 시간대 순으로 정렬해야 합니다.

---

### 💡 풀이 과정
- 0시부터 23시까지의 시간을 담은 가상 테이블을 `WITH RECURSIVE`로 생성.
- 생성된 시간 테이블과 입양 기록 테이블을 `LEFT JOIN`하여 기록이 없는 시간대도 0으로 출력되도록 함.

```sql
WITH RECURSIVE HOURS AS (
  SELECT 0 AS HOUR
  UNION ALL
  SELECT HOUR + 1
  FROM HOURS
  WHERE HOUR < 23
)
SELECT
  H.HOUR AS HOUR,
  COUNT(A.ANIMAL_ID) AS COUNT
FROM HOURS H
LEFT JOIN ANIMAL_OUTS A
  ON H.HOUR = HOUR(A.DATETIME)
GROUP BY
  H.HOUR
ORDER BY
  H.HOUR;
```
