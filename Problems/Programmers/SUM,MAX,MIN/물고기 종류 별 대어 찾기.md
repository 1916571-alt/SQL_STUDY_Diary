# 1228_물고기 종류 별 대어 찾기

날짜: 2025년 12월 28일
대분류: SQL 블로깅
분류번호: 프로그래머스
설명: SUM,MAX,MIN
중분류: LV_3

```sql
WITH
base_info AS(
    SELECT I.ID,
           N.FISH_NAME,
           I.LENGTH
    FROM FISH_INFO I
    JOIN FISH_NAME_INFO N
        ON I.FISH_TYPE = N.FISH_TYPE
),
max_info AS(
    SELECT FISH_NAME, MAX(LENGTH) AS group_max_length
    FROM base_info
    GROUP BY FISH_NAME
)
SELECT bi.ID,
       bi.FISH_NAME,
       bi.LENGTH
FROM base_info AS bi
JOIN max_info AS mi
    ON bi.FISH_NAME = mi.FISH_NAME AND
       bi.LENGTH = mi.group_max_length
```

1. 기본 리스트 테이블 추출
2. MAX_테이블 추출

*주의  “ bi.LENGTH = mi.group_max_length” 이거만 하게 되면 길이만 같으면 JOIN되어서, 중복 ROW 발생.