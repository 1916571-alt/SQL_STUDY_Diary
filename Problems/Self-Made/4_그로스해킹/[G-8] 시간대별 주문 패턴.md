# 시간대별 주문 패턴

> **정보**
> - **날짜**: 2026년 01월 21일
> - **분류**: Self-Made (G-8)
> - **주제**: 피크타임 분석
> - **난이도**: ★★
> - **재풀이 여부**: X

---

### 문제 설명

시간대별 주문 패턴을 분석하여 피크타임을 식별하세요.

**테이블**: orders

**출력**: order_hour | order_count | total_revenue | avg_order_value | order_share

---

### 정답 풀이

```sql
SELECT
    HOUR(order_datetime) AS order_hour,
    COUNT(*) AS order_count,
    SUM(total_amount) AS total_revenue,
    ROUND(AVG(total_amount), 0) AS avg_order_value,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS order_share
FROM orders
WHERE YEAR(order_date) = 2024
GROUP BY HOUR(order_datetime)
ORDER BY order_hour;
```

---

### 핵심 포인트

1. **HOUR()**: datetime에서 시간(0-23) 추출
2. **비율 계산**: 윈도우 함수로 전체 대비 비율
3. **활용**: 피크타임 프로모션, 서버 용량 계획, 인력 배치
