# 메뉴별 판매 분석

> **정보**
> - **날짜**: 2026년 01월 21일
> - **분류**: Self-Made (G-11)
> - **주제**: 크로스탭 분석
> - **난이도**: ★★
> - **재풀이 여부**: X

---

### 문제 설명

카테고리별 월간 판매량을 크로스탭 형태로 분석하세요.

**테이블**: orders, order_items, products, categories

**출력**: category_name | 2024-01 | 2024-02 | ... | total_qty

---

### 정답 풀이

```sql
SELECT
    c.name AS category_name,
    SUM(CASE WHEN DATE_FORMAT(o.order_date, '%Y-%m') = '2024-01' THEN oi.quantity ELSE 0 END) AS `2024-01`,
    SUM(CASE WHEN DATE_FORMAT(o.order_date, '%Y-%m') = '2024-02' THEN oi.quantity ELSE 0 END) AS `2024-02`,
    SUM(CASE WHEN DATE_FORMAT(o.order_date, '%Y-%m') = '2024-03' THEN oi.quantity ELSE 0 END) AS `2024-03`,
    SUM(CASE WHEN DATE_FORMAT(o.order_date, '%Y-%m') = '2024-04' THEN oi.quantity ELSE 0 END) AS `2024-04`,
    SUM(CASE WHEN DATE_FORMAT(o.order_date, '%Y-%m') = '2024-05' THEN oi.quantity ELSE 0 END) AS `2024-05`,
    SUM(CASE WHEN DATE_FORMAT(o.order_date, '%Y-%m') = '2024-06' THEN oi.quantity ELSE 0 END) AS `2024-06`,
    SUM(oi.quantity) AS total_qty
FROM order_items oi
JOIN orders o ON oi.order_id = o.id
JOIN products p ON oi.product_id = p.id
JOIN categories c ON p.category_id = c.id
WHERE YEAR(o.order_date) = 2024
GROUP BY c.name
ORDER BY total_qty DESC;
```

---

### 핵심 포인트

1. **크로스탭**: 행(카테고리) × 열(월) 형태의 피벗 테이블
2. **CASE + SUM**: 조건부 집계로 열 생성
3. **가독성**: 월별 트렌드를 한눈에 파악 가능
