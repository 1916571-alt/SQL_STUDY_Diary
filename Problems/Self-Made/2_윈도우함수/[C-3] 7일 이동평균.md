# 7일 이동평균

> **정보**
> - **날짜**: 2026년 01월 21일
> - **분류**: Self-Made (C-3)
> - **주제**: 윈도우 함수 - ROWS BETWEEN
> - **난이도**: ★★
> - **재풀이 여부**: X

---

### 문제 설명

일별 매출의 7일 이동평균을 계산하세요.

**테이블**: daily_sales

**출력**: sale_date | daily_revenue | moving_avg_7days

---

### 정답 풀이

```sql
WITH daily AS (
    SELECT
        sale_date,
        SUM(revenue) AS daily_revenue
    FROM daily_sales
    GROUP BY sale_date
)
SELECT
    sale_date,
    daily_revenue,
    ROUND(
        AVG(daily_revenue) OVER (
            ORDER BY sale_date
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ),
        2
    ) AS moving_avg_7days
FROM daily
ORDER BY sale_date;
```

---

### 핵심 포인트

1. **ROWS BETWEEN**: 윈도우 프레임 직접 지정
2. **6 PRECEDING + CURRENT**: 총 7일 (오늘 포함)
3. **이동평균 용도**: 단기 노이즈 제거, 트렌드 파악
