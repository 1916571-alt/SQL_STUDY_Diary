# 누적 매출

> **정보**
> - **날짜**: 2026년 01월 21일
> - **분류**: Self-Made (C-2)
> - **주제**: 윈도우 함수 - SUM() OVER
> - **난이도**: ★★
> - **재풀이 여부**: X

---

### 문제 설명

2024년 월별 매출과 누적 매출, 연간 목표 대비 달성률을 계산하세요. (연간 목표: 12억)

**테이블**: orders

**출력**: year_month | monthly_revenue | cumulative_revenue | achievement_rate

---

### 정답 풀이

```sql
WITH monthly AS (
    SELECT
        DATE_FORMAT(order_date, '%Y-%m') AS year_month,
        SUM(total_amount) AS monthly_revenue
    FROM orders
    WHERE YEAR(order_date) = 2024
    GROUP BY DATE_FORMAT(order_date, '%Y-%m')
),
cumulative AS (
    SELECT
        year_month,
        monthly_revenue,
        SUM(monthly_revenue) OVER (ORDER BY year_month) AS cumulative_revenue
    FROM monthly
)
SELECT
    year_month,
    monthly_revenue,
    cumulative_revenue,
    ROUND(cumulative_revenue / 1200000000 * 100, 2) AS achievement_rate
FROM cumulative
ORDER BY year_month;
```

---

### 핵심 포인트

1. **SUM() OVER (ORDER BY ...)**: 누적합 계산의 핵심
2. **ROWS 기본값**: ORDER BY만 있으면 ROWS UNBOUNDED PRECEDING AND CURRENT ROW
3. **달성률 계산**: 누적 매출 / 연간 목표 × 100
