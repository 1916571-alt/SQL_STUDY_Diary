# 시간대별 주문 분포

> **정보**
> - **날짜**: 2026년 01월 21일
> - **분류**: Self-Made (E-4)
> - **주제**: HOUR + 구간 분류
> - **난이도**: ★★
> - **재풀이 여부**: X

---

### 문제 설명

시간대별 주문 분포를 분석하여 피크타임을 파악하세요.

**테이블**: orders (order_datetime)

**출력**: time_slot | order_count | total_revenue | percentage

---

### 정답 풀이

```sql
SELECT
    CASE
        WHEN HOUR(order_datetime) BETWEEN 6 AND 10 THEN '아침 (06-10)'
        WHEN HOUR(order_datetime) BETWEEN 11 AND 13 THEN '점심 (11-13)'
        WHEN HOUR(order_datetime) BETWEEN 14 AND 17 THEN '오후 (14-17)'
        WHEN HOUR(order_datetime) BETWEEN 18 AND 21 THEN '저녁 (18-21)'
        ELSE '심야 (22-05)'
    END AS time_slot,
    COUNT(*) AS order_count,
    SUM(total_amount) AS total_revenue,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS percentage
FROM orders
WHERE YEAR(order_date) = 2024
GROUP BY
    CASE
        WHEN HOUR(order_datetime) BETWEEN 6 AND 10 THEN '아침 (06-10)'
        WHEN HOUR(order_datetime) BETWEEN 11 AND 13 THEN '점심 (11-13)'
        WHEN HOUR(order_datetime) BETWEEN 14 AND 17 THEN '오후 (14-17)'
        WHEN HOUR(order_datetime) BETWEEN 18 AND 21 THEN '저녁 (18-21)'
        ELSE '심야 (22-05)'
    END
ORDER BY order_count DESC;
```

---

### 핵심 포인트

1. **HOUR()**: datetime에서 시간(0-23) 추출
2. **BETWEEN으로 구간 설정**: 시간대별 슬롯 정의
3. **비율 계산**: `COUNT(*) / SUM(COUNT(*)) OVER ()` 패턴
